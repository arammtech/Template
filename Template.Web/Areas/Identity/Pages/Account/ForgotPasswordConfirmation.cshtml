@page
@model ForgotPasswordConfirmation
@{
    Layout = "_IdentityLayout";
    ViewData["Title"] = "Forgot password confirmation";
}

<form class="f-ctr-ctr flex-column" method="post" style="gap: 4.2rem !important;">
    <input type="hidden" asp-for="Input.Email"/>
    <div class="row">
        <div class="col-12 f-ctr-ctr flex-column">
            <h1 class="big-text fw-bold tc-3">@Model.Input.Message</h1>
        </div>
    </div>

    <div asp-validation-summary="ModelOnly" class="div-validations" role="alert"></div>
    <div class="row gy-4 form-container">
          <div class="col-12 f-ctr-ctr">
            <input type="text" asp-for="Input.Digit6" maxlength="1" class="btn-icon size-sm bg-sh code-input" required>
            <input type="text" asp-for="Input.Digit5" maxlength="1" class="btn-icon size-sm bg-sh code-input" required>
            <input type="text" asp-for="Input.Digit4" maxlength="1" class="btn-icon size-sm bg-sh code-input" required>
            <input type="text" asp-for="Input.Digit3" maxlength="1" class="btn-icon size-sm bg-sh code-input" required>
            <input type="text" asp-for="Input.Digit2" maxlength="1" class="btn-icon size-sm bg-sh code-input" required>
            <input type="text" asp-for="Input.Digit1" maxlength="1" class="btn-icon size-sm bg-sh code-input" required>
        </div>
        <!-- Verify button -->
        <div class="col-12">
            <button type="submit" name="action" value="verify" class="tc-3 hov-zoom-in">تحقق</button>
        </div>
        <!-- Resend code button (you may include a timer or disable logic as needed) -->
        <div class="col-12 f-str-ctr size-lg bg-sh round-2">
            <span class="tc-acc mx-5">6 دقائق</span>
            <button type="button" id="resendButton" class="tc-3 hov-zoom-in">إعادة إرسال الرمز</button>
        </div>
    </div>
</form>

@section Scripts {
    <partial name="_ValidationScriptsPartial" />
    <script>
             // Function to handle resend button click
        document.getElementById('resendButton').addEventListener('click', function () {
            // Temporarily disable the required attribute
            const inputs = document.querySelectorAll('.code-input');
            inputs.forEach(input => input.removeAttribute('required'));

            // Create a new form submission for resending the code
            const form = this.closest('form');
            const actionInput = document.createElement('input');
            actionInput.type = 'hidden';
            actionInput.name = 'action';
            actionInput.value = 'resend';
            form.appendChild(actionInput);
            form.submit();
        });

        document.addEventListener("DOMContentLoaded", function () {
            let inputs = document.querySelectorAll('.code-input');

            inputs.forEach((input, index, array) => {
                input.addEventListener('input', function () {
                    if (this.value.length === 1 && index > 0) {
                        array[index - 1].focus(); // Move cursor to the LEFT
                    }
                });

                input.addEventListener('keydown', function (event) {
                    if (event.key === 'Backspace' && this.value.length === 0 && index < array.length - 1) {
                        array[index + 1].focus(); // Move cursor to the RIGHT on delete
                    }
                });
            });
        });
    </script>
}


